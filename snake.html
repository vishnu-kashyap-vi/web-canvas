<!DOCTYPE html>
<html>
<head>
  <title>Snake & Ladder | V √ó S</title>
  <meta charset="UTF-8">
  <link rel="icon" type="image/jpg" href="favicon.jpg">
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    /* ==== BOARD LOOK ==== */
    .board {
      display: grid;
      grid-template-columns: repeat(10, 40px);
      grid-template-rows: repeat(10, 40px);
      border: 4px solid #f97373;
      background: radial-gradient(circle at top left, #1e293b 0, #020617 60%);
    }

    .cell {
      width: 40px;
      height: 40px;
      font-size: 10px;
      color: #e5e5e5;
      display: flex;
      align-items: flex-end;
      justify-content: center;
      border: 1px solid rgba(148, 163, 184, 0.4);
      position: relative;
    }

    .cell:nth-child(odd) {
      background: rgba(30, 64, 175, 0.35);
    }

    .cell:nth-child(even) {
      background: rgba(22, 163, 74, 0.35);
    }

    /* Pawns (tokens) */
    .dot {
      width: 14px;
      height: 14px;
      border-radius: 999px;
      position: absolute;
      top: 4px;
      transition: transform 0.15s linear;
    }

    /* Player colors: red, blue, green, yellow */
    .dot.p1 {
      left: 3px;
      background: #ef4444; /* red */
      box-shadow: 0 0 10px rgba(239, 68, 68, 0.9);
    }
    .dot.p2 {
      right: 3px;
      background: #3b82f6; /* blue */
      box-shadow: 0 0 10px rgba(59, 130, 246, 0.9);
    }
    .dot.p3 {
      left: 3px;
      bottom: 3px;
      background: #22c55e; /* green */
      box-shadow: 0 0 10px rgba(34, 197, 94, 0.9);
    }
    .dot.p4 {
      right: 3px;
      bottom: 3px;
      background: #eab308; /* yellow */
      box-shadow: 0 0 10px rgba(234, 179, 8, 0.9);
    }

    /* Markers for snakes/ladders */
    .marker {
      position: absolute;
      top: 2px;
      left: 2px;
      font-size: 9px;
      font-weight: 700;
    }
    .snake {
      color: #f97373;
    }
    .ladder {
      color: #4ade80;
    }

    /* Active player highlight in list */
    .player-active {
      border-color: #a855f7;
      box-shadow: 0 0 12px rgba(168,85,247,0.7);
    }
  </style>
</head>

<body class="min-h-screen bg-gradient-to-b from-black via-slate-900 to-black text-white">
  <div class="max-w-6xl mx-auto px-4 py-8 flex flex-col lg:flex-row gap-8">

    <!-- LEFT: BOARD -->
    <div class="flex flex-col items-center gap-3">
      <a href="index.html" class="self-start text-sm text-slate-300 hover:text-purple-300">
        &larr; Back to Home
      </a>

      <h1 class="text-3xl font-extrabold text-purple-400 drop-shadow-md text-center">
        Snake &amp; Ladder
      </h1>

      <p class="text-xs text-slate-300 text-center max-w-xs">
        2‚Äì4 players on one device. Animated pawns, dice, snakes & ladders.
      </p>

      <div id="board" class="board"></div>
    </div>

    <!-- RIGHT: CONTROLS -->
    <div class="flex-1 flex flex-col gap-4">

      <!-- Setup -->
      <div class="bg-white/5 border border-white/10 rounded-2xl p-4 backdrop-blur flex flex-col gap-3">
        <p class="font-semibold text-slate-100 text-sm">Setup</p>

        <div class="flex flex-wrap items-center gap-3 text-xs text-slate-200">
          <span>Number of players:</span>
          <select id="playerCount" class="bg-black/40 border border-slate-600 rounded px-2 py-1">
            <option value="2">2 players</option>
            <option value="3">3 players</option>
            <option value="4">4 players</option>
          </select>
        </div>

        <div class="grid grid-cols-2 gap-2 text-xs text-slate-200">
          <label>
            Player 1 (üî¥ red):
            <input id="p1Name" class="mt-1 w-full bg-black/40 border border-red-400/60 rounded px-2 py-1"
                   placeholder="Player 1">
          </label>
          <label>
            Player 2 (üîµ blue):
            <input id="p2Name" class="mt-1 w-full bg-black/40 border border-blue-400/60 rounded px-2 py-1"
                   placeholder="Player 2">
          </label>
          <label>
            Player 3 (üü¢ green):
            <input id="p3Name" class="mt-1 w-full bg-black/40 border border-emerald-400/60 rounded px-2 py-1"
                   placeholder="(optional)">
          </label>
          <label>
            Player 4 (üü° yellow):
            <input id="p4Name" class="mt-1 w-full bg-black/40 border border-yellow-400/60 rounded px-2 py-1"
                   placeholder="(optional)">
          </label>
        </div>

        <button id="startBtn"
                class="mt-2 px-4 py-2 rounded-full bg-cyan-500 hover:bg-cyan-400 text-xs font-semibold
                       shadow-[0_0_15px_rgba(34,211,238,0.8)] w-fit">
          ‚úÖ Start game
        </button>

        <p id="setupInfo" class="text-[11px] text-slate-300 min-h-[1.3rem]"></p>
      </div>

      <!-- Game panel -->
      <div class="bg-white/5 border border-white/10 rounded-2xl p-5 backdrop-blur flex flex-col gap-3">
        <p id="turnText" class="font-semibold text-purple-300 text-sm">
          Click "Start game" to begin
        </p>

        <div id="playerList" class="grid grid-cols-2 gap-3 text-xs">
          <!-- filled by JS -->
        </div>

        <div class="flex items-center gap-4">
          <p>Dice:
            <span id="diceValue"
                  class="inline-flex items-center justify-center w-10 h-10 rounded-lg border border-yellow-400
                         font-mono text-xl bg-black/40 shadow-[0_0_15px_rgba(250,204,21,0.6)]">
              -
            </span>
          </p>
          <span id="diceAnimHint" class="text-[11px] text-slate-400">
            Click roll to see dice animation.
          </span>
        </div>

        <div class="flex gap-3 items-center">
          <button id="rollBtn"
                  class="px-5 py-2 rounded-full bg-purple-500 hover:bg-purple-400 text-white font-semibold
                         shadow-[0_0_20px_rgba(168,85,247,0.9)] transition disabled:opacity-40 disabled:cursor-not-allowed"
                  disabled>
            üé≤ Roll Dice
          </button>
          <button id="resetBtn"
                  class="text-xs text-slate-300 hover:text-slate-100 underline">
            Reset positions
          </button>
        </div>

        <p id="message" class="text-xs text-slate-200 min-h-[1.5rem]"></p>
      </div>

      <!-- Legend -->
      <div class="bg-white/5 border border-white/10 rounded-2xl p-4 text-xs text-slate-300">
        <p class="font-semibold mb-1 text-red-300">Snakes üêç</p>
        <p>99 ‚Üí 54, 70 ‚Üí 55, 52 ‚Üí 42, 25 ‚Üí 2</p>
        <p class="font-semibold mt-2 mb-1 text-emerald-300">Ladders ü™ú</p>
        <p>3 ‚Üí 22, 5 ‚Üí 8, 11 ‚Üí 26, 20 ‚Üí 29</p>
      </div>

    </div>
  </div>

  <script>
    /* ========== 1. BOARD + SNAKE/LADDER DATA ========== */

    const boardElement = document.getElementById('board');
    const cells = {};

    const snakes = {
      99: 54,
      70: 55,
      52: 42,
      25: 2
    };

    const ladders = {
      3: 22,
      5: 8,
      11: 26,
      20: 29
    };

    function buildBoard() {
      boardElement.innerHTML = "";
      for (let i = 100; i >= 1; i--) {
        const cell = document.createElement('div');
        cell.className = 'cell';
        cell.dataset.num = i;
        cell.textContent = i;

        if (snakes[i]) {
          const m = document.createElement('span');
          m.className = 'marker snake';
          m.textContent = 'S';
          cell.appendChild(m);
        }
        if (ladders[i]) {
          const m = document.createElement('span');
          m.className = 'marker ladder';
          m.textContent = 'L';
          cell.appendChild(m);
        }

        boardElement.appendChild(cell);
        cells[i] = cell;
      }
    }

    buildBoard();

    /* ========== 2. GAME STATE ========== */

    let players = [];            // { name, pos, color }
    let currentPlayerIndex = 0;
    let gameOver = false;
    let isAnimating = false;     // prevents spam while moving

    /* ========== 3. DOM ELEMENTS ========== */

    const playerCountSel = document.getElementById('playerCount');
    const p1NameInput    = document.getElementById('p1Name');
    const p2NameInput    = document.getElementById('p2Name');
    const p3NameInput    = document.getElementById('p3Name');
    const p4NameInput    = document.getElementById('p4Name');

    const startBtn       = document.getElementById('startBtn');
    const setupInfoEl    = document.getElementById('setupInfo');

    const turnTextEl     = document.getElementById('turnText');
    const diceEl         = document.getElementById('diceValue');
    const diceHintEl     = document.getElementById('diceAnimHint');
    const playerListEl   = document.getElementById('playerList');
    const rollBtn        = document.getElementById('rollBtn');
    const resetBtn       = document.getElementById('resetBtn');
    const messageEl      = document.getElementById('message');

    /* ========== 4. RENDER PLAYERS LIST ========== */

    function renderPlayerList() {
      playerListEl.innerHTML = "";
      players.forEach((p, index) => {
        const div = document.createElement('div');
        const isActive = index === currentPlayerIndex && !gameOver;
        div.className = "bg-black/40 border border-white/10 rounded-lg p-2 transition " +
                        (isActive ? "player-active" : "");

        const colorName =
          p.color === "p1" ? "red" :
          p.color === "p2" ? "blue" :
          p.color === "p3" ? "green" : "yellow";

        const colorDotClass =
          p.color === "p1" ? "bg-red-400" :
          p.color === "p2" ? "bg-blue-400" :
          p.color === "p3" ? "bg-emerald-400" : "bg-yellow-400";

        div.innerHTML = `
          <p class="font-semibold text-xs">
            <span class="inline-block w-2 h-2 rounded-full mr-1 ${colorDotClass}"></span>
            ${p.name} (${colorName})
          </p>
          <p class="text-[11px]">Position: ${p.pos}</p>
        `;
        playerListEl.appendChild(div);
      });
    }

    /* ========== 5. DRAW DOTS ON BOARD ========== */

    function updateBoardTokens() {
      document.querySelectorAll('.cell').forEach(c => {
        c.querySelectorAll('.dot').forEach(d => d.remove());
      });

      players.forEach(p => {
        const cell = cells[p.pos];
        if (!cell) return;
        const dot = document.createElement('div');
        dot.className = 'dot ' + p.color;
        cell.appendChild(dot);
      });

      renderPlayerList();
    }

    /* ========== 6. START GAME ========== */

    function startGame() {
      const count = Number(playerCountSel.value); // 2‚Äì4

      players = [];
      const colors = ["p1", "p2", "p3", "p4"];

      for (let i = 0; i < count; i++) {
        let name;
        if (i === 0) {
          name = p1NameInput.value.trim() || "Player 1";
        } else if (i === 1) {
          name = p2NameInput.value.trim() || "Player 2";
        } else if (i === 2) {
          name = p3NameInput.value.trim() || "Player 3";
        } else {
          name = p4NameInput.value.trim() || "Player 4";
        }

        players.push({
          name,
          pos: 1,
          color: colors[i]
        });
      }

      currentPlayerIndex = 0;
      gameOver = false;
      isAnimating = false;
      diceEl.textContent = "-";
      messageEl.textContent = "";
      rollBtn.disabled = false;
      setupInfoEl.textContent = `Game started with ${players.length} players.`;

      updateBoardTokens();
      updateTurnText();
    }

    startBtn.addEventListener('click', startGame);

    function updateTurnText() {
      if (!players.length) {
        turnTextEl.textContent = 'Click "Start game" to begin.';
        return;
      }
      const p = players[currentPlayerIndex];
      if (gameOver) {
        turnTextEl.textContent = `${p.name} finished the game.`;
      } else {
        turnTextEl.textContent = `${p.name}'s turn`;
      }
      renderPlayerList();
    }

    /* ========== 7. ANIMATED MOVE HELPERS ========== */

    // Animate stepping through each square in "path" array
    function animatePath(player, path, onDone) {
      if (path.length === 0) {
        onDone();
        return;
      }

      isAnimating = true;
      rollBtn.disabled = true;

      let i = 0;
      const interval = setInterval(() => {
        player.pos = path[i];
        updateBoardTokens();
        i++;
        if (i >= path.length) {
          clearInterval(interval);
          isAnimating = false;
          rollBtn.disabled = false;
          onDone();
        }
      }, 150); // 150ms per step
    }

    /* ========== 8. MAIN ROLL + DICE ANIMATION ========== */

    function rollForCurrentPlayer() {
      if (gameOver || !players.length || isAnimating) return;

      const player = players[currentPlayerIndex];

      // Dice rolling animation
      let frames = 12;
      let count = 0;
      diceHintEl.textContent = "";
      rollBtn.disabled = true;

      const anim = setInterval(() => {
        diceEl.textContent = Math.floor(Math.random() * 6) + 1;
        count++;
        if (count >= frames) {
          clearInterval(anim);

          const dice = Math.floor(Math.random() * 6) + 1; // final roll
          diceEl.textContent = dice;
          processMove(player, dice);
        }
      }, 60);
    }

    function processMove(player, dice) {
      if (gameOver) return;

      let startPos = player.pos;
      let basePos = startPos + dice;

      if (basePos > 100) {
        messageEl.textContent = `${player.name} rolled ${dice} but can't move beyond 100. Stays on ${player.pos}.`;
        nextTurn();
        return;
      }

      let finalPos = basePos;
      let msg = `${player.name} rolled ${dice} and moved to ${basePos}. `;

      if (ladders[basePos]) {
        const dest = ladders[basePos];
        msg += `ü™ú Ladder from ${basePos} ‚Üí ${dest}. `;
        finalPos = dest;
      }

      if (snakes[basePos]) {
        const dest = snakes[basePos];
        msg += `üêç Snake from ${basePos} ‚Üí ${dest}. `;
        finalPos = dest;
      }

      // Build path for animation: step to basePos, then to finalPos (if different)
      const path = [];

      for (let p = startPos + 1; p <= basePos; p++) {
        path.push(p);
      }

      if (finalPos !== basePos) {
        const step = finalPos > basePos ? 1 : -1;
        for (let p = basePos + step; step > 0 ? p <= finalPos : p >= finalPos; p += step) {
          path.push(p);
        }
      }

      animatePath(player, path, () => {
        messageEl.textContent = msg;

        if (player.pos === 100) {
          messageEl.textContent = msg + `üèÜ ${player.name} wins!`;
          gameOver = true;
          rollBtn.disabled = true;
          updateTurnText();
          return;
        }

        nextTurn();
      });
    }

    function nextTurn() {
      currentPlayerIndex = (currentPlayerIndex + 1) % players.length;
      updateTurnText();
    }

    rollBtn.addEventListener('click', rollForCurrentPlayer);

    /* ========== 9. RESET POSITIONS ========== */

    function resetGame() {
      if (!players.length) return;
      players.forEach(p => p.pos = 1);
      currentPlayerIndex = 0;
      gameOver = false;
      isAnimating = false;
      diceEl.textContent = "-";
      messageEl.textContent = "";
      rollBtn.disabled = false;
      updateBoardTokens();
      updateTurnText();
    }

    resetBtn.addEventListener('click', resetGame);
  </script>
</body>
</html>
